const miModulo = (() => {
  "use strict";
  let e = [],
    t = ["C", "D", "H", "S"],
    l = ["A", "J", "Q", "K"],
    r = [],
    a = document.querySelector("#btnPedir"),
    n = document.querySelector("#btnDetener"),
    d = document.querySelector("#btnNuevo"),
    s = document.querySelectorAll(".divCartas"),
    o = document.querySelectorAll("small"),
    i = (t = 2) => {
      (e = u()), (r = []);
      for (let l = 0; l < t; l++) r.push(0);
      for (let d = 0; d < o.length; d++)
        (o[d].innerText = 0), (s[d].innerHTML = "");
      (a.disabled = !1), (n.disabled = !1);
    },
    u = () => {
      e = [];
      for (let r = 2; r <= 10; r++) for (let a of t) e.push(r + a);
      for (let n of t) for (let d of l) e.push(d + n);
      return (e = _.shuffle(e));
    },
    c = () => {
      if (0 === e.length) throw "No hay cartas en el deck";
      let t = e.pop();
      return t;
    },
    $ = (e) => {
      let t = e.substring(0, e.length - 1);
      return isNaN(t) ? ("A" === t ? 11 : 10) : 1 * t;
    },
    b = (e, t) => ((r[t] = r[t] + $(e)), (o[t].innerText = r[t]), r[t]),
    f = (e, t) => {
      let l = document.createElement("img");
      (l.src = `assets/cartas/${e}.png`),
        l.classList.add("carta"),
        s[t].append(l);
    },
    g = () => {
      setTimeout(() => {
        let [e, t] = r;
        t === e
          ? alert("Nadie gana :(")
          : e > 21
          ? alert("Computadora gana")
          : t > 21
          ? alert("Jugador Gana")
          : alert("Computadora Gana");
      }, 100);
    },
    h = (e) => {
      let t = r.length - 1,
        l = 0;
      do {
        let a = c();
        (l = b(a, t)), f(a, t);
      } while (l < e && e <= 21);
      g();
    };
  return (
    a.addEventListener("click", () => {
      let e = c(),
        t = 0,
        l = b(e, t);
      f(e, t),
        l > 21
          ? (console.warn("Lo siento mucho, perdiste"),
            (a.disabled = !0),
            (n.disabled = !0),
            h(l))
          : 21 === l &&
            (console.warn("21, genial!"),
            (a.disabled = !0),
            (n.disabled = !0),
            h(l));
    }),
    n.addEventListener("click", () => {
      (a.disabled = !0), (n.disabled = !0), h(r[0]);
    }),
    d.addEventListener("click", () => {
      i();
    }),
    { nuevoJuego: i }
  );
})();
